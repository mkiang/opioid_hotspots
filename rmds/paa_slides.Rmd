---
title: "Geographic Variation in Opioid Mortality by Race/Ethnicity, 1999--2016"
subtitle: "Identifying epidemic hotspots"
author: 
  - "Mathew Kiang\\inst{1}"
  - "Monica Alexander\\inst{2}"
  - "Zhe Zhang\\inst{3}"
  - "Jarvis Chen\\inst{1}"
institute:
  - "\\inst{1}Deptartment of Social and Behavioral Sciences \\newline  Harvard TH Chan School of Public Health"
  - "\\inst{2}Department of Demography \\newline University of California, Berkeley"
  - "\\inst{3}Heinz College \\newline Carnegie Mellon University"
# date: "`r format(Sys.time(), '%d %B %Y')`"
date: "PAA 2018: Denver, CO"
# fontsize: 12pt
classoption: 
  - compress
  # - "aspectratio=169"
output: 
  beamer_presentation:
    theme: "CambridgeUS"
    color: "dolphin"
    fonttheme: "structurebold"
    incremental: true
    keep_tex: true
    includes:
      in_header: paa_header.tex
    dev: cairo_pdf
    fig_width: 6
    fig_height: 4
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(error = FALSE)
knitr::opts_chunk$set(message = FALSE)
library(tidyverse)
library(here)
library(geofacet)
library(statebins)
library(viridis)
library(gridExtra)
```


# Overview of the opioid epidemic

## Almost 30x increase since 1980

```{r, cache=TRUE}
f1 <- readRDS(here("plots", "grobs", "presentation_fig1.RDS"))
print(f1)
```

## More than deaths by car accidents or guns
```{r, cache=TRUE}
f1a <- readRDS(here("plots", "grobs", "presentation_fig1a.RDS"))
print(f1a)
```

## Wave 1: Prescription Opioids, 1990--2010

```{r, cache=TRUE}
f2 <- readRDS(here("plots", "grobs", "presentation_fig2.RDS"))
print(f2)
```

## Wave 2: Heroin, 2010--current

```{r, cache=TRUE}
f3 <- readRDS(here("plots", "grobs", "presentation_fig3.RDS"))
print(f3)
```

## Wave 3: Synthetic Opioids, 2013--current

```{r, cache=TRUE}
f4 <- readRDS(here("plots", "grobs", "presentation_fig4.RDS"))
print(f4)
```

# Other sources of variation

## Substantial variation: By race/ethnicity
```{r, cache=TRUE}
f5 <- readRDS(here("plots", "grobs", "presentation_fig5.RDS"))
print(f5)
```

## Substantial variation: By geography
```{r, cache=TRUE}
f6 <- readRDS(here("plots", "grobs", "presentation_fig6.RDS"))
print(f6)
```

# Our paper

## Aims of the paper

1. Systematically describe the opioid epidemic across geography (state), race/ethnicity, and opioid type.
    - The epidemic over time (1999--2016)
    - The *current* epidemic in terms of both mortality rate and rate of increase
2. Identify "epidemic hotspots" --- areas with high mortality and rapid increases

## Methods

- Multiple cause of death data from NCHS to calculate age-standardized rates by state, race/ethnicity, and opioid type
- Joinpoint regression (stratified by race/ethnicity, state, opioid type)
    - Log-normal segmented weighted least squares regression
    - Grid-search to find optimal joinpoint locations (0-3)
    - Permutation test to find optimal joinpoint model
- Defined statistical significance as $P < 0.01$

# Results: Current epidemic

## Example Joinpoint Results: Maryland
```{r, cache=TRUE}
f7 <- readRDS(here("plots", "grobs", "fig_example_jp_MD.RDS"))
print(f7)
```

## Current Mortality
```{r, cache=TRUE, fig.height=6.5, fig.width=11}
f9 <- readRDS(here("plots", "grobs", "current_rates_map.RDS"))
print(f9)
```

## Current Trajectory
```{r, cache=TRUE, fig.height=6.5, fig.width=11}
f10 <- readRDS(here("plots", "grobs", "current_trajectory_map.RDS"))
print(f10)
```

## Epidemic Hotspots
```{r, cache=TRUE, fig.height=8, fig.width=11, fig.align='center'}
p_legend <- readRDS(here('plots', 'grobs', 'hotspots_legend.RDS'))
p1 <- readRDS(here('plots', 'grobs', 'hotspots_map.RDS'))

grid.arrange(p1, p_legend,  heights = c(4, 1.5), nrow=2)
```

## Results

- No decreases in opioid mortality
- Where there were increases, it is just as bad (or worse) for the black population
- Increases are driven by heroin and synthetic opioids
    - Heroin deaths increased 30-34\% per year for both populations
    - Synthetic opioids increased 70\% per year for whites and 150\% for blacks
    - Synthetic opioids are doubling in 12 states for whites and 18 for blacks
- Strong geographical clustering of epidemic hotspots
    - Especially for heroin and synthetic opioid mortality
    - Little evidence this is due to differences in heroin/opioid use
    - Lots of evidence that source of heroin/synthetic opioids is important

## Conclusions

- Interventions must be local and tailored to region, race/ethnicity, and opioid type
- Supply-side interventions need to be balanced with harm reduction interventions
    - Syringe exchange programs
    - Medication assisted treatment
    - Increased naloxone access
    - Drug testing on-site and point-of-site
    - Supervised consumption sites
- Surveillance of illicit markets needs to be dramatically improved
    - Better measurement of potency of drugs
    - Types of drugs
    - Cost and availability
    
## Thank you
\Large
\begin{center}
\textbf{Code and interactive results explorer:} \\ \texttt{https://tiny.cc/paa2018} \newline \newline

 mathewkiang.com | \faGithub: mkiang | \faTwitter: @mathewkiang 

\end{center}

## Epidemic Hotspots
```{r, cache=TRUE, fig.height=5, fig.width=8}
f14 <- readRDS(here('plots', 'grobs', 'hotspots_scatter_final.RDS'))
print(f14)
```

## Average Annual Percent Change
```{r, cache=TRUE, fig.height=6.5, fig.width=11}
f15 <- readRDS(here('plots', 'grobs', 'aapc_map.RDS'))
print(f15)
```
